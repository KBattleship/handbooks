---
title: "2.ElasticSearch集群原理"
date: 2019-12-22T15:36:27+08:00
lastmod: 2019-12-22T15:36:27+08:00
keywords: ['middleware']
description: ""
tags: ['java','elasticsearch','分布式']
categories: ['middleware']
author: ""
---
# ElasticSearch集群原理
### 一、关于ES集群需要思考几个问题
+ 需要多大规模的集群？

```shell
# 首先从两个方面考虑
①.数据量有多大？数据增长情况如何？
②.服务器硬件设施配置：CPU、Memory、Disk

# 推算依据
ES Jvm heap 最大设置为32G。
30G heap大约可以存储数据量10T；服务器memory若为128G，可运行多个实例节点。

# 应用场景
A:用于构建业务搜索模块，且多是垂直领域搜索。（数据量级几千万至十亿级,一般需要2-4台机器）
B:用于大规模数据的实时联机处理分析(OLAP),例如ELK，数据规模可达上千亿乃至更多，需要几十甚至上百实例节点。
```
+ 集群中节点角色如何分配？

```shell
# 一个节点可以充当一个或多个角色，默认三个角色都有
# 节点角色
①.Master
    node.master: true   # 实例节点为主节点
②.DataNode
    node.data: true     # 默认是数据节点。
③.CoordinateNode
    # 以上两项置为false，则此节点为协调节点；
    # 协调节点：一个节点只作为接收请求、转发请求到其他节点、汇总各个节点返回数据等功能的节点。
    
# 具体分配
A:小规模集群不需要具体区分；
B:中、大规模集群(十个节点以上)，并发查询量大，查询的合并量大，可以增加独立的协调节点。角色分开的好处是分工分开，不互影响。如不会因协调角色负载过高而影响数据节点的能力。
```
+ 如何避免脑裂问题发生？

```shell

```
+ 索引应该设置多少个分片？
+ 分片应该设置多少个副本？


